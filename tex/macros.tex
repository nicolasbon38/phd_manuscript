% !TeX_ROOT=../thesis.tex

\newcommand{\TODO}[1]{\todo[inline, color=orange!30]{\textbf{TODO:} #1}}
\newcommand{\Question}[1]{\todo[inline, color=red!30]{\textbf{Question:} #1}}
\newcommand{\sonia}[1]{\todo[inline, color=blue!30]{\textbf{Sonia:} #1}}
\newcommand{\david}[1]{\todo[inline, color=green!30]{\textbf{David:} #1}}

% Setting bold for vectors
\let\vec\mathbf
%Setting \mathcal font for matrices
\let\mat\mathcal

% Classical Spaces
\newcommand{\B}{\mathbb{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\F}{\mathbb{F}}

% Distributions
\newcommand{\unif}[1]{\mathcal U \left ( #1 \right )}


% Problems / Ciphertexts
\newcommand{\LWE}{\textsf{LWE}}
\newcommand{\TrivialLWE}{\textsf{TrivialLWE}}
\newcommand{\RLWE}{\textsf{RLWE}}
\newcommand{\GLWE}{\textsf{GLWE}}
\newcommand{\TrivialGLWE}{\textsf{TrivialGLWE}}
\newcommand{\GGSW}{\textsf{GGSW}}

% Classical Mathematical Operations
\newcommand{\rounding}[1]{\left \lfloor #1 \right \rceil}
\newcommand{\modulo}[2]{\left [ #1 \right ]_{#2}}
\newcommand{\drawfrom}{\overset{\$}{\leftarrow}}
\newcommand{\innerProduct}[2]{\left \langle #1, #2 \right \rangle}
\newcommand{\abs}[1]{\left \lvert #1 \right \rvert}
\newcommand{\norm}[1]{\lVert #1 \rVert}

% TFHE-specific notations
\newcommand{\lweSigma}{\sigma_{\LWE}}
\newcommand{\glweSigma}{\sigma_{\GLWE}}
\newcommand{\baseDecomp}{\mathfrak{B}}
\newcommand{\levelDecomp}{\ell}
\newcommand{\baseDecompPBS}{\mathfrak{B}_{\textsf{PBS}}}
\newcommand{\levelDecompPBS}{\ell_{\textsf{PBS}}}
\newcommand{\baseDecompKS}{\mathfrak{B}_{\textsf{KS}}}
\newcommand{\levelDecompKS}{\ell_{\textsf{KS}}}

\newcommand{\lweSecretKey}{\vec s}
\newcommand{\glweSecretKey}{\vec S}

\newcommand{\BSK}{\textsf{BSK}} 
\newcommand{\KSK}{\textsf{KSK}} 
% TODO : trouver une otation plus jolie pour BSK
\newcommand{\acc}{\textsf{acc}(X)}


%TFHE homomorphic operations

\newcommand{\sumTFHE}[2]{\texttt{SumTFHE}(#1, #2)}
\newcommand{\sumTFHETernary}[3]{\texttt{SumTFHE}(#1, #2, #3)}
\newcommand{\sumTFHEQuad}[4]{\texttt{SumTFHE}(#1, #2, #3, #4)}
\newcommand{\clearMultTFHE}[2]{\texttt{ClearMultTFHE}(#1, #2)}


% Bootstrapping operations
\newcommand{\ModSwitch}{\texttt{ModSwitch}~}
\newcommand{\BlindRotate}{\texttt{BlindRotate}~}
\newcommand{\SampleExtract}{\texttt{SampleExtract}~}
\newcommand{\KeySwitch}{\texttt{KeySwitch}~}
\newcommand{\PackingKeySwitch}{\texttt{PackingKeySwitch}~}
\newcommand{\CMUX}{\texttt{CMUX}~}

% other operations
\newcommand{\decomp}[3]{\textbf{\textsf{dec}}^{(#1, #2)}(#3)}


% TFHE-related spaces\\
\newcommand{\plaintextTorus}{\mathbb{T}_p}
\newcommand{\plaintextRing}{\mathbb{Z}_p}
\newcommand{\plaintextTorusPoly}{\mathbb{T}_p[X] / (X^N + 1)}
\newcommand{\plaintextRingPolyFull}{\mathbb{Z}_p[X] / (X^N + 1)}
\newcommand{\plaintextRingPoly}{\mathbb{Z}_{N,p}[X]}
\newcommand{\lweTorus}{\mathbb{T}_q}
\newcommand{\lweRing}{\mathbb{Z}_q}
\newcommand{\glweTorus}{\mathbb{T}_q[X] / (X^N + 1)}
\newcommand{\glweRingFull}{\mathbb{Z}_q[X] / (X^N + 1)}
\newcommand{\glweRing}{\mathbb{Z}_{N,q}[X]}
\newcommand{\glweRingSecretKey}{\mathbb{B}_{N,q}[X)}

% environments
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\theoremstyle{property}
\newtheorem{property}{Property}[section]
\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}[section]
\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}[section]
\theoremstyle{primitive}
\newtheorem{primitive}{Primitive}

% Macros for the p-encodings section
\newcommand{\Encoding}{\mathcal{E}}
\newcommand{\EncDef}[2]{\begin{cases} 0 \mapsto #1 \\ 1 \mapsto #2 \end{cases}}
\newcommand{\EncDefZero}[1]{\begin{cases} 0 \mapsto #1 \\ 1 \mapsto \{0\} \end{cases}}
\newcommand{\EncDefOne}[1]{\begin{cases} 0 \mapsto \{0\} \\ 1 \mapsto \{#1\} \end{cases}}


% Macros for the Hippogryph section
\newcommand{\hippo}{\texttt{Hippogryph}}
\newcommand{\ie}{\textit{i.e.,}}



\newcommand{\EncDefCanonicalBinary}[3]{
	\begin{cases}
		\Z_2 \mapsto \Z_{#1} \\
		0 \mapsto \{#2\} \\ 
		1 \mapsto \{#3\}
	\end{cases}
}

\newcommand{\EncDefCanonical}[2]{
	\begin{cases}
		\Z_{#1} \mapsto \Z_{#2} \\
		0 \mapsto \{0\} \\
		\vdots \\
		#1 - 1 \mapsto \{#1 - 1\}
	\end{cases}
}


% AES Cipher Step Macros
\newcommand{\SubBytes}{\texttt{SubBytes}~}
\newcommand{\ShiftRows}{\texttt{ShiftRows}~}
\newcommand{\MixColumns}{\texttt{MixColumns}~}
\newcommand{\AddRoundKey}{\texttt{AddRoundKey}~}
\newcommand{\KeyExpansion}{\texttt{KeyExpansion}~}


%Macro from orpheud
\newcommand{\perr}{p_{\textsf{err}}}
\newcommand{\toolName}{\textsf{ORPHEUS}\xspace}